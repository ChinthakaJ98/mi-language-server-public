{
  "name": "ForEachMediator",
  "type": "mediator",
  "title": "ForEach Mediator",
  "canTryOut": true,
  "help": "Iterate over a list and then merges back the result.",
  "elements": [
    {
      "type": "attribute",
      "value": {
        "name": "version",
        "displayName": "version",
        "inputType": "string",
        "required": false,
        "defaultValue": "v2",
        "helpTip": "",
        "hidden": true
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "collection",
        "displayName": "Collection to iterate",
        "inputType": "expression",
        "required": true,
        "helpTip": "The collection to iterate over. This can be a JSON array or XML list",
        "enableCondition": [
          {
            "version": "v2"
          }
        ]
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "parallelExecution",
        "displayName": "Execute Parallel",
        "inputType": "checkbox",
        "defaultValue": true,
        "required": false,
        "helpTip": "If enabled, the messages will be processed in parallel. If disabled, the messages will be processed sequentially.",
        "enableCondition": [
          {
            "version": "v2"
          }
        ]
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "continueWithoutAggregation",
        "displayName": "Continue without aggregation",
        "inputType": "checkbox",
        "defaultValue": false,
        "required": false,
        "helpTip": "If enabled, the parent flow will continue without waiting for the aggregation.",
        "enableCondition": [
          {
            "version": "v2"
          }
        ]
      }
    },
    {
      "type": "attributeGroup",
      "value": {
        "groupName": "Output Configurations",
        "enableCondition": [
          "AND",
          {
            "version": "v2"
          },
          {
            "continueWithoutAggregation": false
          }
        ],
        "elements": [
          {
            "type": "attribute",
            "value": {
              "name": "updateOriginalContent",
              "displayName": "Update original collection",
              "inputType": "checkbox",
              "defaultValue": true,
              "required": false,
              "helpTip": "If enabled, the original list will be updated with the content. The content type should be the same as the original collection content type."
            }
          },
          {
            "type": "attribute",
            "value": {
              "name": "resultTarget",
              "displayName": "Variable Name",
              "inputType": "string",
              "required": true,
              "helpTip": "The name of the variable where the new content will be saved.",
              "enableCondition": [
                {
                  "updateOriginalContent": false
                }
              ]
            }
          },
          {
            "type": "attribute",
            "value": {
              "name": "resultType",
              "displayName": "Variable Type",
              "inputType": "combo",
              "defaultValue": "JSON",
              "comboValues": [
                "JSON",
                "XML"
              ],
              "required": true,
              "helpTip": "The type of the variable where the new content will be saved.",
              "enableCondition": [
                {
                  "updateOriginalContent": false
                }
              ]
            }
          },
          {
            "type": "attribute",
            "value": {
              "name": "rootElement",
              "displayName": "Result Enclosing Element Name",
              "inputType": "string",
              "defaultValue": "ForEachResult",
              "required": true,
              "helpTip": "The aggregation result will be wrapped in this root element.",
              "enableCondition": [
                "AND",
                {
                  "updateOriginalContent": false
                },
                {
                  "resultType": "XML"
                }
              ]
            }
          }
        ]
      }
    },
    {
      "type": "attributeGroup",
      "value": {
        "groupName": "Advanced",
        "isCollapsed": "true",
        "enableCondition": [
          "AND",
          {
            "version": "v2"
          },
          {
            "parallelExecution": false
          }
        ],
        "elements": [
          {
            "type": "attribute",
            "value": {
              "name": "counterVariableName",
              "displayName": "Counter Variable Name",
              "inputType": "string",
              "defaultValue": "",
              "required": "false",
              "helpTip": "You can access the current iteration number using this variable within the ForEach mediator."
            }
          }
        ]
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "forEachID",
        "displayName": "ForEach ID",
        "inputType": "string",
        "required": false,
        "helpTip": "",
        "enableCondition": [
          {
            "version": "v1"
          }
        ]
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "forEachExpression",
        "displayName": "ForEach Expression",
        "inputType": "expression",
        "expressionType":"xpath/jsonPath",
        "required": true,
        "helpTip": "",
        "enableCondition": [
          {
            "version": "v1"
          }
        ]
      }
    },
    {
      "type": "attributeGroup",
      "value": {
        "groupName": "Sequence",
        "enableCondition": [
          {
            "version": "v1"
          }
        ],
        "elements": [
          {
            "type": "attribute",
            "value": {
              "name": "sequenceType",
              "displayName": "Sequence Type",
              "inputType": "combo",
              "defaultValue": "Anonymous",
              "comboValues": [
                "Anonymous",
                "Key"
              ],
              "required": false,
              "helpTip": ""
            }
          },
          {
            "type": "attribute",
            "value": {
              "name": "sequenceKey",
              "displayName": "Sequence Key",
              "inputType": "key",
              "enableCondition": [
                {
                  "sequenceType": "Key"
                }
              ],
              "required": false,
              "helpTip": "",
              "keyType": "sequence"
            }
          }
        ]
      }
    },
    {
      "type": "attribute",
      "value": {
        "name": "description",
        "displayName": "Description",
        "inputType": "string",
        "required": false,
        "helpTip": ""
      }
    }
  ]
}
